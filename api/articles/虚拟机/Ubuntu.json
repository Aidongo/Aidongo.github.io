{"title":"VM虚拟机","uid":"799ea85b1d457160335b421a8e814a56","slug":"虚拟机/Ubuntu","date":"2023-04-13T15:30:00.000Z","updated":"2023-07-09T05:28:09.008Z","comments":true,"path":"api/articles/虚拟机/Ubuntu.json","keywords":null,"cover":"https://s2.loli.net/2023/04/14/b8koHcGrJmnve4j.jpg","content":"<h2 id=\"VM虚拟机挂起、重启后无法联网\"><a href=\"#VM虚拟机挂起、重启后无法联网\" class=\"headerlink\" title=\"VM虚拟机挂起、重启后无法联网\"></a>VM虚拟机挂起、重启后无法联网</h2><h3 id=\"原因\"><a href=\"#原因\" class=\"headerlink\" title=\"原因\"></a>原因</h3><p>Ubuntu 默认网卡 ens33 在虚拟机启动时，没有自动启动 &#x3D;&gt; 设置的静态ip无法生效</p>\n<h3 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h3><ol>\n<li><p>查看网卡托管是否启动 <code>nmcli n </code></p>\n</li>\n<li><p>开启托管 <code>nmcli n on</code></p>\n</li>\n<li><p>重启 <code>systemctl restar NetworkManager</code> 或者 <code>reboot</code></p>\n</li>\n<li><p>检查 ens33 网口是否自启动： <code>ip addr</code></p>\n<p><img src=\"https://s2.loli.net/2023/04/14/RDqzhXtvbQxwk17.png\" alt=\"image-20230413232807290\"></p>\n<ul>\n<li>如果ens33 下面有ip地址说明，网卡自启成功</li>\n</ul>\n</li>\n</ol>\n<p>\t\t</p>\n<h3 id=\"自启动脚本\"><a href=\"#自启动脚本\" class=\"headerlink\" title=\"自启动脚本\"></a>自启动脚本</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">#!&#x2F;bin&#x2F;bash\n\n# 检查网卡托管状态\nnmcli n\n\n# 启用网卡托管\nnmcli n on\n\n# 重启 NetworkManager 服务\nsystemctl restart NetworkManager\n\n# 检查 ens33 网卡是否自启动\nip addr show ens33</code></pre>\n\n<p>将以上脚本保存为名为 <code>fix_network.sh</code> 的文件，然后在终端中执行以下命令赋予执行权限：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">chmod +x fix_network.sh</code></pre>\n\n<p>最后，通过以下命令运行脚本：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">.&#x2F;fix_network.sh</code></pre>\n\n<p>脚本将按照解决方案中所述的步骤执行操作，并输出 ens33 网卡的状态。您可以根据输出来确定网卡是否已自启动以及问题是否已解决。</p>\n<h3 id=\"开机自启动设置\"><a href=\"#开机自启动设置\" class=\"headerlink\" title=\"开机自启动设置\"></a>开机自启动设置</h3><ol>\n<li>将脚本移动到 <code>/etc/init.d/</code> 目录下：</li>\n</ol>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo mv fix_network.sh &#x2F;etc&#x2F;init.d&#x2F;</code></pre>\n\n<ol start=\"2\">\n<li>授予脚本执行权限：</li>\n</ol>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo chmod +x &#x2F;etc&#x2F;init.d&#x2F;fix_network.sh</code></pre>\n\n<ol start=\"3\">\n<li>使用 <code>update-rc.d</code> 命令将脚本添加到启动项中：</li>\n</ol>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo update-rc.d fix_network.sh defaults</code></pre>\n\n<ol start=\"4\">\n<li>现在，脚本应该在系统启动时自动执行。您可以重新启动系统来验证脚本是否正确添加到启动项中：</li>\n</ol>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">sudo reboot</code></pre>\n\n<p>在系统重新启动后，脚本将自动运行，并执行解决方案中的操作。</p>\n","feature":true,"text":"VM虚拟机挂起、重启后无法联网原因Ubuntu 默认网卡 ens33 在虚拟机启动时，没有自动启动 &#x3D;&gt; 设置的静态ip无法生效 解决方案 查看网卡托管是否启动 nmcli n 开启托管 nmcli n on 重启 systemctl restar Network...","link":"","photos":[],"count_time":{"symbolsCount":882,"symbolsTime":"1 mins."},"categories":[{"name":"虚拟机","slug":"虚拟机","count":1,"path":"api/categories/虚拟机.json"}],"tags":[{"name":"Ubuntu","slug":"Ubuntu","count":1,"path":"api/tags/Ubuntu.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8C%82%E8%B5%B7%E3%80%81%E9%87%8D%E5%90%AF%E5%90%8E%E6%97%A0%E6%B3%95%E8%81%94%E7%BD%91\"><span class=\"toc-text\">VM虚拟机挂起、重启后无法联网</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8E%9F%E5%9B%A0\"><span class=\"toc-text\">原因</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">解决方案</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%87%AA%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">自启动脚本</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8%E8%AE%BE%E7%BD%AE\"><span class=\"toc-text\">开机自启动设置</span></a></li></ol></li></ol>","author":{"name":"ARBIN","slug":"arbin","avatar":"https://s2.loli.net/2023/04/04/dZv3NaCepc7X4MO.jpg","link":"/","description":"立志成为潮流研究生","socials":{"github":"https://github.com/Aidongo","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"Notion":{"icon":"/svg/notion_black_logo_icon_147102.png","link":"https://arbin29.notion.site/ARBIN-HomePage-641b7c55779f4920869022cad678e8a5"}}}},"mapped":true,"prev_post":{},"next_post":{"title":"Compiler Testing OpenJDK","uid":"a37f6487303dd9ac4600a84c9410fc39","slug":"Project/Compile Testing OpenJDK11u-dev","date":"2023-04-11T18:50:00.000Z","updated":"2023-04-12T03:35:28.160Z","comments":true,"path":"api/articles/Project/Compile Testing OpenJDK11u-dev.json","keywords":null,"cover":"https://s2.loli.net/2023/04/12/vARHi2sdFJMYnIp.png","text":"System Environment Distributor ID Ubuntu Description Ubuntu 20.04.5 LTS Release 20.04 Codename focal Download Source CodeOpenJDK11u-dev Buil...","link":"","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"Project","slug":"Project","count":1,"path":"api/categories/Project.json"}],"tags":[{"name":"Compiler Testing","slug":"Compiler-Testing","count":1,"path":"api/tags/Compiler-Testing.json"}],"author":{"name":"ARBIN","slug":"arbin","avatar":"https://s2.loli.net/2023/04/04/dZv3NaCepc7X4MO.jpg","link":"/","description":"立志成为潮流研究生","socials":{"github":"https://github.com/Aidongo","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"Notion":{"icon":"/svg/notion_black_logo_icon_147102.png","link":"https://arbin29.notion.site/ARBIN-HomePage-641b7c55779f4920869022cad678e8a5"}}}},"feature":true}}